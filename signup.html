<!doctype html>
form{display:grid;gap:12px;margin-top:12px}
input,button,select{width:100%;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
button{background:linear-gradient(90deg,var(--accent),#60a5fa);border:none;color:#042029;font-weight:700}
.row{display:flex;gap:8px}
small{color:var(--muted)}
.note{background:var(--glass);padding:10px;border-radius:8px}
@media(max-width:520px){.card{padding:16px}}
</style>
</head>
<body>
<div class="card">
<h2>Create an account</h2>
<div class="muted">Start with $100 in your demo wallet.</div>
<form id="signupForm">
<input required id="name" placeholder="Full name" />
<input required id="email" type="email" placeholder="Email address" />
<input required id="username" placeholder="Username (unique)" />
<input required id="password" type="password" placeholder="Password" />
<div class="row">
<select id="country"><option value="PK">Pakistan</option><option value="US">United States</option><option value="IN">India</option></select>
<select id="currency"><option value="USD">USD</option><option value="PKR">PKR</option></select>
</div>
<small class="muted">We hash passwords client-side for demo. This is a local demo â€” do not use real credentials you care about.</small>
<div style="display:flex;gap:8px;margin-top:8px">
<button type="submit">Sign up</button>
<a href="login.html" style="align-self:center;color:var(--muted);text-decoration:underline">Already have account?</a>
</div>
</form>
</div>


<script>
// helper: SHA-256 via Web Crypto
async function sha256(str){
const enc = new TextEncoder();
const data = enc.encode(str);
const hashBuf = await crypto.subtle.digest('SHA-256', data);
const hashArr = Array.from(new Uint8Array(hashBuf));
return hashArr.map(b=>b.toString(16).padStart(2,'0')).join('');
}


function loadUsers(){
try{return JSON.parse(localStorage.getItem('ps_users')||'{}');}catch(e){return{}}}
function saveUsers(u){localStorage.setItem('ps_users', JSON.stringify(u));}


document.getElementById('signupForm').addEventListener('submit', async (e)=>{
e.preventDefault();
const name = document.getElementById('name').value.trim();
const email = document.getElementById('email').value.trim().toLowerCase();
const username = document.getElementById('username').value.trim().toLowerCase();
const password = document.getElementById('password').value;
if(!name||!email||!password||!username) return alert('Complete the form');


const users = loadUsers();
// uniqueness
for(const k in users){if(users[k].email===email||users[k].username===username) return alert('User with email or username exists');}


const passHash = await sha256(password+location.hostname);
const newUser = {name, email, username, passwordHash:passHash, balance:100.00, currency:'USD', transactions:[], created:Date.now(), twofa:false};
users[email]=newUser; saveUsers(users);
// create mailbox entry
const mailbox = JSON.parse(localStorage.getItem('ps_mailbox')||'[]');
mailbox.push({to:email,subject:'Welcome to CoinSend',body:`Hello ${name}, welcome! Your demo wallet has $100.`,date:Date.now()});
localStorage.setItem('ps_mailbox', JSON.stringify(mailbox));
// auto-login
localStorage.setItem('session_email', email);
alert('Account created! Redirecting to dashboard...');
location.href='dashboard.html';
});
</script>
